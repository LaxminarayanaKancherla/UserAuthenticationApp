<div class="min-vh-100 bg-light pt-20">
  <div class="container mx-auto p-4 p-md-6">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="text-3xl font-bold text-dark font-poppins">Add New User</h1>
      <button class="btn btn-secondary" (click)="goBack()">Back to Dashboard</button>
    </div>

    <div class="card shadow-sm">
      <div class="card-body p-4">
        <form [formGroup]="addUserForm" (ngSubmit)="addUser()" class="row g-3">
          <div class="col-md-6">
            <div class="form-group" [ngClass]="{'focused': addUserForm.get('email')?.touched || addUserForm.get('email')?.value, 'error': addUserForm.get('email')?.invalid && addUserForm.get('email')?.touched}">
              <label for="add-email">Email</label>
              <input id="add-email" type="email" formControlName="email" class="form-control" (focus)="onFocus('email')" (blur)="onBlur('email')">
              <div *ngIf="addUserForm.get('email')?.invalid && addUserForm.get('email')?.touched" class="error-message">
                <span *ngIf="addUserForm.get('email')?.hasError('required')">Email is required</span>
                <span *ngIf="addUserForm.get('email')?.hasError('email')">Invalid email format</span>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group" [ngClass]="{'focused': addUserForm.get('phone')?.touched || addUserForm.get('phone')?.value, 'error': addUserForm.get('phone')?.invalid && addUserForm.get('phone')?.touched}">
              <label for="add-phone">Phone</label>
              <input id="add-phone" type="text" formControlName="phone" class="form-control" (focus)="onFocus('phone')" (blur)="onBlur('phone')">
              <div *ngIf="addUserForm.get('phone')?.invalid && addUserForm.get('phone')?.touched" class="error-message">
                <span *ngIf="addUserForm.get('phone')?.hasError('required')">Phone is required</span>
                <span *ngIf="addUserForm.get('phone')?.hasError('pattern')">Phone must be exactly 10 digits</span>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group" [ngClass]="{'focused': addUserForm.get('username')?.touched || addUserForm.get('username')?.value, 'error': addUserForm.get('username')?.invalid && addUserForm.get('username')?.touched}">
              <label for="add-username">Username</label>
              <input id="add-username" type="text" formControlName="username" class="form-control" (focus)="onFocus('username')" (blur)="onBlur('username')">
              <div *ngIf="addUserForm.get('username')?.invalid && addUserForm.get('username')?.touched" class="error-message">
                <span *ngIf="addUserForm.get('username')?.hasError('required')">Username is required</span>
                <span *ngIf="addUserForm.get('username')?.hasError('minlength')">Username must be at least 3 characters</span>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group" [ngClass]="{'focused': addUserForm.get('age')?.touched || addUserForm.get('age')?.value, 'error': addUserForm.get('age')?.invalid && addUserForm.get('age')?.touched}">
              <label for="add-age">Age</label>
              <input id="add-age" type="number" formControlName="age" class="form-control" (focus)="onFocus('age')" (blur)="onBlur('age')">
              <div *ngIf="addUserForm.get('age')?.invalid && addUserForm.get('age')?.touched" class="error-message">
                <span *ngIf="addUserForm.get('age')?.hasError('required')">Age is required</span>
                <span *ngIf="addUserForm.get('age')?.hasError('min')">Age must be at least 18</span>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="form-group" [ngClass]="{'focused': addUserForm.get('password')?.touched || addUserForm.get('password')?.value, 'error': addUserForm.get('password')?.invalid && addUserForm.get('password')?.touched}">
              <label for="add-password">Password</label>
              <input id="add-password" type="password" formControlName="password" class="form-control" (focus)="onFocus('password')" (blur)="onBlur('password')">
              <div *ngIf="addUserForm.get('password')?.invalid && addUserForm.get('password')?.touched" class="error-message">
                <span *ngIf="addUserForm.get('password')?.hasError('required')">Password is required</span>
                <span *ngIf="addUserForm.get('password')?.hasError('minlength')">Password must be at least 6 characters</span>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="form-group" [ngClass]="{'focused': addUserForm.get('role')?.touched || addUserForm.get('role')?.value, 'error': addUserForm.get('role')?.invalid && addUserForm.get('role')?.touched}">
              <label for="add-role">Role</label>
              <select id="add-role" formControlName="role" class="form-control" (focus)="onFocus('role')" (blur)="onBlur('role')">
                <option *ngFor="let role of roles" [value]="role.name">{{ role.name }}</option>
              </select>
              <div *ngIf="addUserForm.get('role')?.invalid && addUserForm.get('role')?.touched" class="error-message">
                <span *ngIf="addUserForm.get('role')?.hasError('required')">Role is required</span>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="form-group">
              <label for="add-image">Profile Image</label>
              <input id="add-image" type="file" accept="image/png,image/jpeg" (change)="onFileChange($event)" class="form-control">
              <p class="text-sm text-gray-600 mt-1">Please upload image size below 200KB</p>
            </div>
          </div>
          <div class="col-12 d-flex gap-2">
            <button type="submit" [disabled]="addUserForm.invalid" class="btn btn-primary w-full">Add User</button>
            <button type="button" class="btn btn-secondary w-full" (click)="goBack()">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>